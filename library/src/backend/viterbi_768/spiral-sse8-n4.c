#if defined(NEON_AVAILABLE) || defined(SSE_AVAILABLE)
/***************************************************************
This code was generated by Spiral 6.0 beta, www.spiral.net --
Copyright (c) 2005-2008, Carnegie Mellon University.
All rights reserved.
The code is distributed under the GNU General Public License (GPL)
(see http://www.gnu.org/copyleft/gpl.html)

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
*AS IS* AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
******************************************************************/

#ifdef NEON_AVAILABLE
#include <SSE2NEON.h>
#else
#include <emmintrin.h>
#include <tmmintrin.h>
#endif

#include "spiral-sse8-n4.h"

inline void renormalize(COMPUTETYPE* X, COMPUTETYPE threshold){
      if (X[0]>threshold){
    COMPUTETYPE min=X[0];
    for(int i=0;i<NUMSTATES;i++)
    if (min>X[i])
      min=X[i];
    for(int i=0;i<NUMSTATES;i++)
      X[i]-=min;
      }
}

void init_FULL_SPIRAL() {
}

void FULL_SPIRAL_neon(short  *Y, short  *X, short  *syms, unsigned char  *dec, short  *Branchtab) {
    for(int i9 = 0; i9 <= 1026; i9++) {
        short a177, a183, a189, a195;
        int a175;
        short int s34, s41, s48, s55;
        short  *a176, *a182, *a188, *a194, *b24;
        short int  *a200, *a201, *a218, *a235, *a252;
        __m128i  *a173, *a174, *a179, *a185, *a191, *a197, *a202
                , *a203, *a204, *a205, *a206, *a209, *a212, *a215, *a219
                , *a220, *a221, *a222, *a223, *a226, *a229, *a232, *a236
                , *a237, *a238, *a239, *a240, *a243, *a246, *a249, *a253
                , *a254;
        __m128i a178, a180, a181, a184, a186, a187, a190
                , a192, a193, a196, a198, a199, a207, a208, a210
                , a211, a213, a214, a216, a217, a224, a225, a227
                , a228, a230, a231, a233, a234, a241, a242, a244
                , a245, a247, a248, a250, a251, b25, b26, b27
                , b28, b29, b30, b31, b32, d13, d14, d15
                , d16, d17, d18, d19, d20, m25, m26, m27
                , m28, m29, m30, m31, m32, m33, m34, m35
                , m36, m37, m38, m39, m40, s30, s31, s32
                , s33, s35, s36, s37, s38, s39, s40, s42
                , s43, s44, s45, s46, s47, s49, s50, s51
                , s52, s53, s54, s56, s57, t15, t16, t17
                , t18, t19, t20, t21, t22;
        a173 = ((__m128i  *) X);
        s30 = *(a173);
        a174 = (a173 + 4);
        s31 = *(a174);
        a175 = (8 * i9);
        a176 = (syms + a175);
        a177 = *(a176);
        a178 = _mm_set1_epi16(a177);
        a179 = ((__m128i  *) Branchtab);
        a180 = *(a179);
        a181 = _mm_xor_si128(a178, a180);
        b24 = (a175 + syms);
        a182 = (b24 + 1);
        a183 = *(a182);
        a184 = _mm_set1_epi16(a183);
        a185 = (a179 + 4);
        a186 = *(a185);
        a187 = _mm_xor_si128(a184, a186);
        a188 = (b24 + 2);
        a189 = *(a188);
        a190 = _mm_set1_epi16(a189);
        a191 = (a179 + 8);
        a192 = *(a191);
        a193 = _mm_xor_si128(a190, a192);
        a194 = (b24 + 3);
        a195 = *(a194);
        a196 = _mm_set1_epi16(a195);
        a197 = (a179 + 12);
        a198 = *(a197);
        a199 = _mm_xor_si128(a196, a198);
        b25 = _mm_adds_epi16(a181, a187);
        b26 = _mm_adds_epi16(b25, a193);
        t15 = _mm_adds_epi16(b26, a199);
        t16 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t15);
        m25 = _mm_adds_epi16(s30, t15);
        m26 = _mm_adds_epi16(s31, t16);
        m27 = _mm_adds_epi16(s30, t16);
        m28 = _mm_adds_epi16(s31, t15);
        d13 = _mm_cmpgt_epi16(m25, m26);
        d14 = _mm_cmpgt_epi16(m27, m28);
        s32 = _mm_min_epi16(m26, m25);
        s33 = _mm_min_epi16(m28, m27);
        s34 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d13,_mm_setzero_si128()),_mm_packs_epi16(d14,_mm_setzero_si128())));
        a200 = ((short int  *) dec);
        a201 = (a200 + a175);
        *(a201) = s34;
        s35 = _mm_unpacklo_epi16(s32, s33);
        s36 = _mm_unpackhi_epi16(s32, s33);
        a202 = ((__m128i  *) Y);
        *(a202) = s35;
        a203 = (a202 + 1);
        *(a203) = s36;
        a204 = (a173 + 1);
        s37 = *(a204);
        a205 = (a173 + 5);
        s38 = *(a205);
        a206 = (a179 + 1);
        a207 = *(a206);
        a208 = _mm_xor_si128(a178, a207);
        a209 = (a179 + 5);
        a210 = *(a209);
        a211 = _mm_xor_si128(a184, a210);
        a212 = (a179 + 9);
        a213 = *(a212);
        a214 = _mm_xor_si128(a190, a213);
        a215 = (a179 + 13);
        a216 = *(a215);
        a217 = _mm_xor_si128(a196, a216);
        b27 = _mm_adds_epi16(a208, a211);
        b28 = _mm_adds_epi16(b27, a214);
        t17 = _mm_adds_epi16(b28, a217);
        t18 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t17);
        m29 = _mm_adds_epi16(s37, t17);
        m30 = _mm_adds_epi16(s38, t18);
        m31 = _mm_adds_epi16(s37, t18);
        m32 = _mm_adds_epi16(s38, t17);
        d15 = _mm_cmpgt_epi16(m29, m30);
        d16 = _mm_cmpgt_epi16(m31, m32);
        s39 = _mm_min_epi16(m30, m29);
        s40 = _mm_min_epi16(m32, m31);
        s41 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d15,_mm_setzero_si128()),_mm_packs_epi16(d16,_mm_setzero_si128())));
        a218 = (a201 + 1);
        *(a218) = s41;
        s42 = _mm_unpacklo_epi16(s39, s40);
        s43 = _mm_unpackhi_epi16(s39, s40);
        a219 = (a202 + 2);
        *(a219) = s42;
        a220 = (a202 + 3);
        *(a220) = s43;
        a221 = (a173 + 2);
        s44 = *(a221);
        a222 = (a173 + 6);
        s45 = *(a222);
        a223 = (a179 + 2);
        a224 = *(a223);
        a225 = _mm_xor_si128(a178, a224);
        a226 = (a179 + 6);
        a227 = *(a226);
        a228 = _mm_xor_si128(a184, a227);
        a229 = (a179 + 10);
        a230 = *(a229);
        a231 = _mm_xor_si128(a190, a230);
        a232 = (a179 + 14);
        a233 = *(a232);
        a234 = _mm_xor_si128(a196, a233);
        b29 = _mm_adds_epi16(a225, a228);
        b30 = _mm_adds_epi16(b29, a231);
        t19 = _mm_adds_epi16(b30, a234);
        t20 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t19);
        m33 = _mm_adds_epi16(s44, t19);
        m34 = _mm_adds_epi16(s45, t20);
        m35 = _mm_adds_epi16(s44, t20);
        m36 = _mm_adds_epi16(s45, t19);
        d17 = _mm_cmpgt_epi16(m33, m34);
        d18 = _mm_cmpgt_epi16(m35, m36);
        s46 = _mm_min_epi16(m34, m33);
        s47 = _mm_min_epi16(m36, m35);
        s48 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d17,_mm_setzero_si128()),_mm_packs_epi16(d18,_mm_setzero_si128())));
        a235 = (a201 + 2);
        *(a235) = s48;
        s49 = _mm_unpacklo_epi16(s46, s47);
        s50 = _mm_unpackhi_epi16(s46, s47);
        a236 = (a202 + 4);
        *(a236) = s49;
        a237 = (a202 + 5);
        *(a237) = s50;
        a238 = (a173 + 3);
        s51 = *(a238);
        a239 = (a173 + 7);
        s52 = *(a239);
        a240 = (a179 + 3);
        a241 = *(a240);
        a242 = _mm_xor_si128(a178, a241);
        a243 = (a179 + 7);
        a244 = *(a243);
        a245 = _mm_xor_si128(a184, a244);
        a246 = (a179 + 11);
        a247 = *(a246);
        a248 = _mm_xor_si128(a190, a247);
        a249 = (a179 + 15);
        a250 = *(a249);
        a251 = _mm_xor_si128(a196, a250);
        b31 = _mm_adds_epi16(a242, a245);
        b32 = _mm_adds_epi16(b31, a248);
        t21 = _mm_adds_epi16(b32, a251);
        t22 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t21);
        m37 = _mm_adds_epi16(s51, t21);
        m38 = _mm_adds_epi16(s52, t22);
        m39 = _mm_adds_epi16(s51, t22);
        m40 = _mm_adds_epi16(s52, t21);
        d19 = _mm_cmpgt_epi16(m37, m38);
        d20 = _mm_cmpgt_epi16(m39, m40);
        s53 = _mm_min_epi16(m38, m37);
        s54 = _mm_min_epi16(m40, m39);
        s55 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d19,_mm_setzero_si128()),_mm_packs_epi16(d20,_mm_setzero_si128())));
        a252 = (a201 + 3);
        *(a252) = s55;
        s56 = _mm_unpacklo_epi16(s53, s54);
        s57 = _mm_unpackhi_epi16(s53, s54);
        a253 = (a202 + 6);
        *(a253) = s56;
        a254 = (a202 + 7);
        *(a254) = s57;
        renormalize(Y, 30834);
        short a432, a438, a444, a450;
        int a430;
        short int s104, s111, s90, s97;
        short  *a431, *a437, *a443, *a449, *b61;
        short int  *a455, *a456, *a473, *a490, *a507, *b64;
        __m128i  *a428, *a429, *a434, *a440, *a446, *a452, *a457
                , *a458, *a459, *a460, *a461, *a464, *a467, *a470, *a474
                , *a475, *a476, *a477, *a478, *a481, *a484, *a487, *a491
                , *a492, *a493, *a494, *a495, *a498, *a501, *a504, *a508
                , *a509;
        __m128i a433, a435, a436, a439, a441, a442, a445
                , a447, a448, a451, a453, a454, a462, a463, a465
                , a466, a468, a469, a471, a472, a479, a480, a482
                , a483, a485, a486, a488, a489, a496, a497, a499
                , a500, a502, a503, a505, a506, b62, b63, b65
                , b66, b67, b68, b69, b70, d29, d30, d31
                , d32, d33, d34, d35, d36, m57, m58, m59
                , m60, m61, m62, m63, m64, m65, m66, m67
                , m68, m69, m70, m71, m72, s100, s101, s102
                , s103, s105, s106, s107, s108, s109, s110, s112
                , s113, s86, s87, s88, s89, s91, s92, s93
                , s94, s95, s96, s98, s99, t31, t32, t33
                , t34, t35, t36, t37, t38;
        a428 = ((__m128i  *) Y);
        s86 = *(a428);
        a429 = (a428 + 4);
        s87 = *(a429);
        a430 = (8 * i9);
        b61 = (a430 + syms);
        a431 = (b61 + 4);
        a432 = *(a431);
        a433 = _mm_set1_epi16(a432);
        a434 = ((__m128i  *) Branchtab);
        a435 = *(a434);
        a436 = _mm_xor_si128(a433, a435);
        a437 = (b61 + 5);
        a438 = *(a437);
        a439 = _mm_set1_epi16(a438);
        a440 = (a434 + 4);
        a441 = *(a440);
        a442 = _mm_xor_si128(a439, a441);
        a443 = (b61 + 6);
        a444 = *(a443);
        a445 = _mm_set1_epi16(a444);
        a446 = (a434 + 8);
        a447 = *(a446);
        a448 = _mm_xor_si128(a445, a447);
        a449 = (b61 + 7);
        a450 = *(a449);
        a451 = _mm_set1_epi16(a450);
        a452 = (a434 + 12);
        a453 = *(a452);
        a454 = _mm_xor_si128(a451, a453);
        b62 = _mm_adds_epi16(a436, a442);
        b63 = _mm_adds_epi16(b62, a448);
        t31 = _mm_adds_epi16(b63, a454);
        t32 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t31);
        m57 = _mm_adds_epi16(s86, t31);
        m58 = _mm_adds_epi16(s87, t32);
        m59 = _mm_adds_epi16(s86, t32);
        m60 = _mm_adds_epi16(s87, t31);
        d29 = _mm_cmpgt_epi16(m57, m58);
        d30 = _mm_cmpgt_epi16(m59, m60);
        s88 = _mm_min_epi16(m58, m57);
        s89 = _mm_min_epi16(m60, m59);
        s90 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d29,_mm_setzero_si128()),_mm_packs_epi16(d30,_mm_setzero_si128())));
        a455 = ((short int  *) dec);
        b64 = (a455 + a430);
        a456 = (b64 + 4);
        *(a456) = s90;
        s91 = _mm_unpacklo_epi16(s88, s89);
        s92 = _mm_unpackhi_epi16(s88, s89);
        a457 = ((__m128i  *) X);
        *(a457) = s91;
        a458 = (a457 + 1);
        *(a458) = s92;
        a459 = (a428 + 1);
        s93 = *(a459);
        a460 = (a428 + 5);
        s94 = *(a460);
        a461 = (a434 + 1);
        a462 = *(a461);
        a463 = _mm_xor_si128(a433, a462);
        a464 = (a434 + 5);
        a465 = *(a464);
        a466 = _mm_xor_si128(a439, a465);
        a467 = (a434 + 9);
        a468 = *(a467);
        a469 = _mm_xor_si128(a445, a468);
        a470 = (a434 + 13);
        a471 = *(a470);
        a472 = _mm_xor_si128(a451, a471);
        b65 = _mm_adds_epi16(a463, a466);
        b66 = _mm_adds_epi16(b65, a469);
        t33 = _mm_adds_epi16(b66, a472);
        t34 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t33);
        m61 = _mm_adds_epi16(s93, t33);
        m62 = _mm_adds_epi16(s94, t34);
        m63 = _mm_adds_epi16(s93, t34);
        m64 = _mm_adds_epi16(s94, t33);
        d31 = _mm_cmpgt_epi16(m61, m62);
        d32 = _mm_cmpgt_epi16(m63, m64);
        s95 = _mm_min_epi16(m62, m61);
        s96 = _mm_min_epi16(m64, m63);
        s97 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d31,_mm_setzero_si128()),_mm_packs_epi16(d32,_mm_setzero_si128())));
        a473 = (b64 + 5);
        *(a473) = s97;
        s98 = _mm_unpacklo_epi16(s95, s96);
        s99 = _mm_unpackhi_epi16(s95, s96);
        a474 = (a457 + 2);
        *(a474) = s98;
        a475 = (a457 + 3);
        *(a475) = s99;
        a476 = (a428 + 2);
        s100 = *(a476);
        a477 = (a428 + 6);
        s101 = *(a477);
        a478 = (a434 + 2);
        a479 = *(a478);
        a480 = _mm_xor_si128(a433, a479);
        a481 = (a434 + 6);
        a482 = *(a481);
        a483 = _mm_xor_si128(a439, a482);
        a484 = (a434 + 10);
        a485 = *(a484);
        a486 = _mm_xor_si128(a445, a485);
        a487 = (a434 + 14);
        a488 = *(a487);
        a489 = _mm_xor_si128(a451, a488);
        b67 = _mm_adds_epi16(a480, a483);
        b68 = _mm_adds_epi16(b67, a486);
        t35 = _mm_adds_epi16(b68, a489);
        t36 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t35);
        m65 = _mm_adds_epi16(s100, t35);
        m66 = _mm_adds_epi16(s101, t36);
        m67 = _mm_adds_epi16(s100, t36);
        m68 = _mm_adds_epi16(s101, t35);
        d33 = _mm_cmpgt_epi16(m65, m66);
        d34 = _mm_cmpgt_epi16(m67, m68);
        s102 = _mm_min_epi16(m66, m65);
        s103 = _mm_min_epi16(m68, m67);
        s104 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d33,_mm_setzero_si128()),_mm_packs_epi16(d34,_mm_setzero_si128())));
        a490 = (b64 + 6);
        *(a490) = s104;
        s105 = _mm_unpacklo_epi16(s102, s103);
        s106 = _mm_unpackhi_epi16(s102, s103);
        a491 = (a457 + 4);
        *(a491) = s105;
        a492 = (a457 + 5);
        *(a492) = s106;
        a493 = (a428 + 3);
        s107 = *(a493);
        a494 = (a428 + 7);
        s108 = *(a494);
        a495 = (a434 + 3);
        a496 = *(a495);
        a497 = _mm_xor_si128(a433, a496);
        a498 = (a434 + 7);
        a499 = *(a498);
        a500 = _mm_xor_si128(a439, a499);
        a501 = (a434 + 11);
        a502 = *(a501);
        a503 = _mm_xor_si128(a445, a502);
        a504 = (a434 + 15);
        a505 = *(a504);
        a506 = _mm_xor_si128(a451, a505);
        b69 = _mm_adds_epi16(a497, a500);
        b70 = _mm_adds_epi16(b69, a503);
        t37 = _mm_adds_epi16(b70, a506);
        t38 = _mm_subs_epi16(_mm_set_epi16(1020, 1020, 1020, 1020, 1020, 1020, 1020
    , 1020), t37);
        m69 = _mm_adds_epi16(s107, t37);
        m70 = _mm_adds_epi16(s108, t38);
        m71 = _mm_adds_epi16(s107, t38);
        m72 = _mm_adds_epi16(s108, t37);
        d35 = _mm_cmpgt_epi16(m69, m70);
        d36 = _mm_cmpgt_epi16(m71, m72);
        s109 = _mm_min_epi16(m70, m69);
        s110 = _mm_min_epi16(m72, m71);
        s111 = _mm_movemask_epi8(_mm_unpacklo_epi8(_mm_packs_epi16(d35,_mm_setzero_si128()),_mm_packs_epi16(d36,_mm_setzero_si128())));
        a507 = (b64 + 7);
        *(a507) = s111;
        s112 = _mm_unpacklo_epi16(s109, s110);
        s113 = _mm_unpackhi_epi16(s109, s110);
        a508 = (a457 + 6);
        *(a508) = s112;
        a509 = (a457 + 7);
        *(a509) = s113;
        renormalize(X, 30834);
    }
    /* skip */
}
#endif
